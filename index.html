<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>××ª×›×•× × ×™× ×œ××‘×—×Ÿ ×‘×× ×’×œ×™×ª!</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f0f8ff;
            text-align: center;
            margin: 0;
            padding: 10px;
            color: #333;
            overscroll-behavior: none; /* Prevent pull-to-refresh on mobile */
        }
        h1 { color: #2c3e50; font-size: 1.5rem; margin-bottom: 5px; }
        .card {
            background: white;
            border-radius: 15px;
            padding: 15px;
            margin: 10px auto;
            max-width: 400px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        button {
            background-color: #4CAF50;
            color: white;
            border: none;
            padding: 12px;
            text-align: center;
            font-size: 18px;
            margin: 5px 2px;
            cursor: pointer;
            border-radius: 12px;
            width: 100%;
            touch-action: manipulation;
        }
        button:active { transform: scale(0.98); background-color: #45a049; }
        button.choice-btn { background-color: #2196F3; font-size: 22px; font-weight: bold; margin-bottom: 10px;}
        button.menu-btn { background-color: #ff9800; font-weight: bold; margin-bottom: 10px; box-shadow: 0 2px 5px rgba(0,0,0,0.2); }
        button.sound-btn { background-color: #9c27b0; }
        button.clear-btn { background-color: #e74c3c; width: 48%; display: inline-block; }
        button.check-btn { background-color: #2ecc71; width: 48%; display: inline-block; }
        
        .feedback { font-weight: bold; font-size: 1.2rem; min-height: 30px; margin-top: 10px; }
        .correct { color: green; }
        .wrong { color: red; }
        .hidden { display: none !important; }
        .score-board { font-size: 1.2rem; margin-bottom: 5px; color: #555; font-weight: bold;}
        #question-display { font-size: 2.5rem; margin: 10px 0; color: #333; letter-spacing: 2px; font-weight: bold;}
        
        /* Canvas Styling */
        #canvas-container {
            position: relative;
            margin: 10px auto;
            border: 2px dashed #bbb;
            border-radius: 10px;
            background-color: #fffdf0; /* Paper color */
            touch-action: none; /* Crucial for drawing on mobile */
        }
        canvas {
            display: block;
            cursor: crosshair;
        }
        .self-check-area {
            background: #e8f5e9;
            padding: 10px;
            border-radius: 10px;
            margin-top: 10px;
            animation: fadeIn 0.5s;
        }
        .correct-answer-display {
            font-size: 3rem;
            color: #2e7d32;
            font-family: 'Courier New', monospace; /* Monospace mimics handwriting slightly better */
            margin: 10px 0;
        }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    </style>
</head>
<body>

    <div id="menu" class="card">
        <h1>ğŸ“ ×œ×•××“×™× ×œ××‘×—×Ÿ - ××œ×”</h1>
        <p>×‘×—×¨×™ ××©×—×§:</p>
        <button class="menu-btn" onclick="startGame('letters')">ğŸ…°ï¸ ×”×ª×××ª ××•×ª×™×•×ª (A-a)</button>
        <button class="menu-btn" onclick="startGame('writing')">âœï¸ ×›×ª×™×‘×” (×¦×™×•×¨ ×¢×œ ×”××¡×š)</button>
        <button class="menu-btn" onclick="startGame('names')">ğŸ‘§ ×ª×¨×’×•× ×©××•×ª</button>
        <button class="menu-btn" onclick="startGame('listening')">ğŸ§ ×©××™×¢×” (×¦×‘×¢×™× ×•××¡×¤×¨×™×)</button>
    </div>

    <div id="game-area" class="card hidden">
        <div class="score-board">× ×§×•×“×•×ª: <span id="score">0</span></div>
        <button onclick="showMenu()" style="background-color: #95a5a6; padding: 5px; font-size: 14px; width: auto; position: absolute; top: 15px; left: 15px;">×™×¦×™××”</button>
        
        <div id="question-container">
            <p id="instruction-text" style="font-size: 1.1rem;"></p>
            <div id="question-display"></div>
            
            <div id="choices-area"></div>
            
            <div id="drawing-area" class="hidden">
                <div id="canvas-container">
                    <canvas id="drawCanvas" width="300" height="200"></canvas>
                </div>
                <div id="drawing-controls">
                    <button class="clear-btn" onclick="clearCanvas()">ğŸ—‘ï¸ ×œ××—×•×§</button>
                    <button class="check-btn" onclick="revealAnswer()">×‘×“×™×§×” âœ”ï¸</button>
                </div>
                
                <div id="self-check" class="self-check-area hidden">
                    <p>×”×ª×©×•×‘×” ×”× ×›×•× ×” ×”×™×:</p>
                    <div id="correct-answer-text" class="correct-answer-display"></div>
                    <p>×”×× ×›×ª×‘×ª ×“×•××”?</p>
                    <button onclick="handleSelfCheck(true)" style="background: #4CAF50; width: 45%;">×›×Ÿ! ğŸ‘</button>
                    <button onclick="handleSelfCheck(false)" style="background: #f44336; width: 45%;">×œ× ğŸ‘</button>
                </div>
            </div>
            
            <button id="play-sound-btn" class="sound-btn hidden" onclick="repeatSound()">ğŸ”Š ×”×©××¢ ×©×•×‘</button>
        </div>
        <div id="feedback" class="feedback"></div>
    </div>

<script>
    // --- Data ---
    const letters = [
        { big: 'A', small: 'a' }, { big: 'B', small: 'b' }, 
        { big: 'D', small: 'd' }, { big: 'G', small: 'g' }, 
        { big: 'N', small: 'n' }
    ];

    const wordsToSmall = ['BAG', 'DAD', 'BANANA', 'DAN', 'GAB', 'NAD', 'AND', 'BAND'];
    
    const namesTrans = [
        { en: 'Dan', he: '×“×Ÿ' }, { en: 'Gad', he: '×’×“' }, 
        { en: 'Nad', he: '× ×“' }, { en: 'Ann', he: '××Ÿ' }, 
        { en: 'Dana', he: '×“× ×”' }
    ];

    const listeningData = [
        { word: 'Red', type: 'color', display: 'ğŸŸ¥' },
        { word: 'Blue', type: 'color', display: 'ğŸŸ¦' },
        { word: 'Green', type: 'color', display: 'ğŸŸ©' },
        { word: 'Yellow', type: 'color', display: 'ğŸŸ¨' },
        { word: 'Black', type: 'color', display: 'â¬›' },
        { word: 'One', type: 'number', display: '1' },
        { word: 'Two', type: 'number', display: '2' },
        { word: 'Three', type: 'number', display: '3' },
        { word: 'Four', type: 'number', display: '4' },
        { word: 'Five', type: 'number', display: '5' },
        { word: 'Ten', type: 'number', display: '10' },
        { word: 'Bag', type: 'vocab', display: '×ª×™×§' },
        { word: 'Banana', type: 'vocab', display: '×‘× × ×”' },
        { word: 'Dad', type: 'vocab', display: '××‘×' }
    ];

    // --- State ---
    let score = 0;
    let currentGame = '';
    let currentQuestion = null;

    // --- Canvas Setup ---
    const canvas = document.getElementById('drawCanvas');
    const ctx = canvas.getContext('2d');
    let isDrawing = false;

    // Fix Canvas scaling for mobile screens
    function resizeCanvas() {
        const container = document.getElementById('canvas-container');
        // Make canvas fill the container width, keep aspect ratio roughly
        let width = Math.min(window.innerWidth - 60, 350);
        canvas.width = width;
        canvas.height = 200;
        
        // Setup drawing style
        ctx.lineWidth = 4;
        ctx.lineCap = 'round';
        ctx.strokeStyle = '#000';
    }

    // Drawing Events (Touch & Mouse)
    function startDraw(e) {
        isDrawing = true;
        draw(e);
    }
    function endDraw() {
        isDrawing = false;
        ctx.beginPath();
    }
    function draw(e) {
        if (!isDrawing) return;
        
        e.preventDefault(); // Stop scrolling
        
        let clientX, clientY;
        if(e.touches) {
            clientX = e.touches[0].clientX;
            clientY = e.touches[0].clientY;
        } else {
            clientX = e.clientX;
            clientY = e.clientY;
        }

        const rect = canvas.getBoundingClientRect();
        const x = clientX - rect.left;
        const y = clientY - rect.top;

        ctx.lineTo(x, y);
        ctx.stroke();
        ctx.beginPath();
        ctx.moveTo(x, y);
    }

    // Add Event Listeners
    canvas.addEventListener('mousedown', startDraw);
    canvas.addEventListener('mouseup', endDraw);
    canvas.addEventListener('mousemove', draw);
    
    canvas.addEventListener('touchstart', startDraw, {passive: false});
    canvas.addEventListener('touchend', endDraw);
    canvas.addEventListener('touchmove', draw, {passive: false});

    // --- Game Logic ---

    function showMenu() {
        document.getElementById('menu').classList.remove('hidden');
        document.getElementById('game-area').classList.add('hidden');
        document.getElementById('feedback').innerText = '';
    }

    function startGame(gameType) {
        score = 0;
        document.getElementById('score').innerText = score;
        currentGame = gameType;
        document.getElementById('menu').classList.add('hidden');
        document.getElementById('game-area').classList.remove('hidden');
        resizeCanvas();
        nextQuestion();
    }

    function nextQuestion() {
        document.getElementById('feedback').innerText = '';
        const display = document.getElementById('question-display');
        const choices = document.getElementById('choices-area');
        const drawingArea = document.getElementById('drawing-area');
        const instruction = document.getElementById('instruction-text');
        const soundBtn = document.getElementById('play-sound-btn');
        
        // Reset UI
        choices.innerHTML = '';
        drawingArea.classList.add('hidden');
        soundBtn.classList.add('hidden');
        display.classList.remove('hidden');
        document.getElementById('self-check').classList.add('hidden');
        document.getElementById('drawing-controls').classList.remove('hidden');

        if (currentGame === 'letters') {
            instruction.innerText = "××™×–×• ××•×ª ×§×˜× ×” ××ª××™××” ×œ××•×ª ×”×’×“×•×œ×”?";
            let item = letters[Math.floor(Math.random() * letters.length)];
            currentQuestion = item;
            display.innerText = item.big;
            
            let options = [item.small];
            while(options.length < 3) {
                let r = letters[Math.floor(Math.random() * letters.length)].small;
                if(!options.includes(r)) options.push(r);
            }
            shuffle(options).forEach(opt => createButton(opt, opt === item.small));

        } else if (currentGame === 'writing') {
            instruction.innerText = "×¦×™×™×¨×™ ××ª ×”××™×œ×” ×‘××•×ª×™×•×ª ×§×˜× ×•×ª:";
            let word = wordsToSmall[Math.floor(Math.random() * wordsToSmall.length)];
            currentQuestion = word;
            display.innerText = word;
            
            drawingArea.classList.remove('hidden');
            clearCanvas();

        } else if (currentGame === 'names') {
            instruction.innerText = "××” ×”×ª×¨×’×•× ×”× ×›×•×Ÿ?";
            let item = namesTrans[Math.floor(Math.random() * namesTrans.length)];
            currentQuestion = item;
            display.innerText = item.en;
            
            let options = [item.he];
            while(options.length < 3) {
                let r = namesTrans[Math.floor(Math.random() * namesTrans.length)].he;
                if(!options.includes(r)) options.push(r);
            }
            shuffle(options).forEach(opt => createButton(opt, opt === item.he));

        } else if (currentGame === 'listening') {
            instruction.innerText = "×œ×—×¦×™ ×¢×œ ×”×¨××§×•×œ ×•×‘×—×¨×™ ×ª×©×•×‘×”:";
            let item = listeningData[Math.floor(Math.random() * listeningData.length)];
            currentQuestion = item;
            display.classList.add('hidden');
            soundBtn.classList.remove('hidden');
            
            setTimeout(() => speak(item.word), 500);

            let options = [item];
            while(options.length < 4) {
                let r = listeningData[Math.floor(Math.random() * listeningData.length)];
                if(!options.includes(r)) options.push(r);
            }
            shuffle(options).forEach(opt => createButton(opt.display, opt.word === item.word));
        }
    }

    function createButton(text, isCorrect) {
        const btn = document.createElement('button');
        btn.innerText = text;
        btn.className = 'choice-btn';
        btn.onclick = () => handleAnswer(isCorrect);
        document.getElementById('choices-area').appendChild(btn);
    }

    // Drawing Logic Helper
    function clearCanvas() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
    }

    function revealAnswer() {
        // Hide controls, show check area
        document.getElementById('drawing-controls').classList.add('hidden');
        const selfCheck = document.getElementById('self-check');
        selfCheck.classList.remove('hidden');
        document.getElementById('correct-answer-text').innerText = currentQuestion.toLowerCase();
    }

    function handleSelfCheck(isCorrect) {
        if (isCorrect) {
            handleAnswer(true);
        } else {
            handleAnswer(false);
        }
    }

    function handleAnswer(isCorrect) {
        const fb = document.getElementById('feedback');
        if (isCorrect) {
            fb.innerText = "×›×œ ×”×›×‘×•×“! ××ª ××œ×•×¤×”! â­";
            fb.className = "feedback correct";
            score += 10;
            document.getElementById('score').innerText = score;
            speak("Good job"); 
            setTimeout(nextQuestion, 2000);
        } else {
            fb.innerText = "×œ× × ×•×¨×, × ×¡×™ ×©×•×‘ ×‘×¤×¢× ×”×‘××” ğŸ˜‰";
            fb.className = "feedback wrong";
            setTimeout(nextQuestion, 2000); // Move on anyway
        }
    }

    function speak(text) {
        if ('speechSynthesis' in window) {
            const msg = new SpeechSynthesisUtterance();
            msg.text = text;
            msg.lang = 'en-US';
            window.speechSynthesis.speak(msg);
        }
    }

    function repeatSound() {
        if(currentQuestion && currentQuestion.word) {
            speak(currentQuestion.word);
        }
    }

    function shuffle(array) {
        return array.sort(() => Math.random() - 0.5);
    }
</script>

</body>
</html>
